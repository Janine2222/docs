<div class="documentation-content">

<div class="wiki-content" id="main-content">

        <h1 id="InterfacesManagementonCiscoIOS-Overview">Overview</h1><p>In this tutorial you will learn how to create a Microservice to manage the interfaces of a Cisco IOS router.</p><p>Although this example is based on Cisco ISR CLI it can be adapted to other type of devices with CLI-based management.</p><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><p class="title">NOTE: Getting the sources</p><div class="confluence-information-macro-body"><p><span>The source of this tutorial are available on GitHub at </span><a class="external-link" href="https://github.com/openmsa/Microservices/tree/master/CISCO" rel="nofollow" target="_blank">https://github.com/openmsa/Microservices/tree/master/CISCO</a><span> </span></p></div></div><h1 id="InterfacesManagementonCiscoIOS-Configurationsample">Configuration sample</h1><p>Here is an example of the configuration that we want to import into our object:</p><p></p><pre>MSA358#sho ip interface</pre><pre>GigabitEthernet1 is administratively down, line protocol is down</pre><pre>  Internet protocol processing disabled</pre><pre>GigabitEthernet2 is up, line protocol is up</pre><pre>  Internet address is 10.30.19.12/23</pre><pre>  Broadcast address is 255.255.255.255</pre><pre>  Address determined by setup command</pre><pre>  MTU is 1500 bytes</pre><pre>  Helper address is not set</pre><pre>  Directed broadcast forwarding is disabled</pre><pre>  Outgoing Common access list is not set</pre><pre>  Outgoing access list is not set</pre><pre>  Inbound Common access list is not set</pre><h1 id="InterfacesManagementonCiscoIOS-IMPORTMethod">IMPORT Method</h1><h2 id="InterfacesManagementonCiscoIOS-ConfigurationParser">Configuration Parser</h2>
        <p><a class="image-popup-fit-width" href="">
          <img alt="Image" src="images/InterfaceImport_CiscoISR.png" width="800"/></a></p>

        <h3 id="InterfacesManagementonCiscoIOS-Detailsoftheparser">Details of the parser</h3><ul><li>Object indentifier extractor</li></ul><pre> @(?&lt;object_id&gt;\S+) is administratively \S+, line protocol is (?&lt;status&gt;\S+)@</pre><pre> @(?&lt;object_id&gt;\S+) is \S+, line protocol is (?&lt;status&gt;\S+)@</pre><ul><li>Objects variable extractor</li></ul><pre> @\s+Internet address is (?&lt;address&gt;\S+)/(?&lt;_cidr&gt;\S+)@</pre><p>it is also possible to extract additional parameters such as MTU, byte in/out, packets in/out</p><pre> @\s+(?&lt;packets_in&gt;\S+) packets input, (?&lt;bytes_in&gt;\S+) bytes@</pre><pre> @\s+(?&lt;packets_out&gt;\S+) packets output, (?&lt;bytes_out&gt;\S+) bytes@</pre><pre> @\s+MTU (?&lt;MTU&gt;\S+) bytes, BW (?&lt;BW&gt;\S+) Kbit/sec@</pre><ul><li>Ignore line parsers</li></ul><pre> @^\s@</pre><h3 id="InterfacesManagementonCiscoIOS-PostImport">Post Import</h3><p>This parser extracts the CIDR number of the subnet, but in the case where we want to display the mask in the form 255.X.X.X then we need to use a post-import operation to create a new variable 'mask':</p><pre>{if !empty($params._cidr)}</pre><pre>{get_mask_from_len len=$params._cidr var="_mask"}</pre><pre> {assign_object_variable var="mask" value=$_mask}</pre><pre>{/if}</pre><h2 id="InterfacesManagementonCiscoIOS-VARIABLES">VARIABLES</h2>
        <p><a class="image-popup-fit-width" href="">
          <img alt="Image" src="images/Interface_variables_CiscoISR.png" width="800"/></a></p>

        <h2 id="InterfacesManagementonCiscoIOS-UPDATE">UPDATE</h2><p>A simple implementation can be used here:</p><pre>interface {$params.object_id}</pre><pre>{if empty($params.address)}</pre><pre> no ip address</pre><pre> shut</pre><pre>{else}</pre><pre> ip address {$params.address} {$params.mask}</pre><pre> no shut</pre><pre>{/if}</pre><h1 id="InterfacesManagementonCiscoIOS-ResultintheMicroserviceConsole">Result in the Microservice Console</h1><p></p>
        <p><a class="image-popup-fit-width" href="">
          <img alt="Image" src="images/InterfaceImport_CiscoISR_result.png" width="800"/></a></p>

        <h1 id="InterfacesManagementonCiscoIOS-DisplaytheInterfaceStatuswithColors">Display the Interface Status with Colors</h1><p>This is useful to enhance the visual aspect of your objects and ease the monitoring of your interface.</p><p>Colourization is done with a POST-IMPORT that assigns the special variable '''_color''':</p><pre>{if  $params.status == down }</pre><pre>      {assign_object_variable var="_color" value=red}</pre><pre>{/if}</pre><pre>{if  $params.status == up }</pre><pre>      {assign_object_variable var="_color" value=green}</pre><pre>{/if}</pre>
        <p><a class="image-popup-fit-width" href="">
          <img alt="Image" src="images/InterfaceImport_CiscoISR_resultWithColor.png" width="800"/></a></p>


        </div>



        </div>