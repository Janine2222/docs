<div class="documentation-content">

<div class="wiki-content" id="main-content">
    <div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info">
        <p class="title">NOTE: Getting the sources</p>
        <div class="confluence-information-macro-body">
            <p><span>The sources of this tutorial are available on GitHub at <a class="external-link" href="https://github.com/openmsa/Workflows-Microservices/tree/master/MICROSERVICES/CISCO/CATALYST_IOS/VLAN" rel="nofollow">https://github.com/openmsa/Workflows-Microservices/tree/master/MICROSERVICES/CISCO/CATALYST_IOS/VLAN</a></span></p>
            <p><span>to use the Microservice for VLAN management, you need to use <a class="external-link" href="https://github.com/openmsa/Workflows-Microservices/blob/master/MICROSERVICES/CISCO/CATALYST_IOS/VLAN/vlan.xml" rel="nofollow" title="vlan.xml">vlan.xml</a> and <a class="external-link" href="https://github.com/openmsa/Workflows-Microservices/blob/master/MICROSERVICES/CISCO/CATALYST_IOS/VLAN/interface.xml" rel="nofollow" title="interface.xml">interface.xml</a> because vlan.xml uses a reference to the interface.xml Microservice.</span></p>
        </div>
    </div>
    <h1 id="MicroservicesOrderCommandRESTAPI-TypeofExecution"><span class="">Type of Execution </span></h1>
    <h2 id="MicroservicesOrderCommandRESTAPI-GenerateConfiguration"><span class="">Generate Configuration </span></h2>
    <p>This execution type is used to preview the configuration to be generated, before storing it in the database or applying it to the device.</p>
    <p>The configuration generated by the command is returned to the caller, no other action is performed.</p>
    <p><a class="image-popup-fit-width" href="">
              <img alt="Image" src="images/BFD-Conf-3.png" width="600"/></a></p>
    <p>REST API syntax</p>
    <div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;">
        <div class="codeContent panelContent pdl">
            <div>
                <div class="syntaxhighlighter sh-confluence nogutter java" id="highlighter_270548">
                    <div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody>
                            <tr>
                                <code class="code">
                                    <div class="container" title="Hint: double-click to select code">
                                        <div class="line number1 index0 alt2"><code class="java plain">POST /ordercommand/get/configuration/{deviceId}/{commandName} </code></div>
                                        <div class="line number2 index1 alt1"><code class="java plain">body : microservice parameters formatted as JSON</code></div>
                                    </div>
                                </code>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <p></p>
    <ul>
        <li><strong>deviceId</strong> is the ID (long) of the device to manage.</li>
        <li><strong>commandName</strong> is the command to apply to the device.</li>
        <li><strong>objectParameters</strong> are the JSON formatted list of objects and attributes.</li>
    </ul>
    <h5 id="MicroservicesOrderCommandRESTAPI-Example">Example</h5>
    <p>The call below is using the Microservice vlan.xml to do simple VLAN management on a Cisco Catalyst IOS</p>
    <div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;">
        <div class="codeContent panelContent pdl">
            <div>
                <div class="syntaxhighlighter sh-confluence nogutter java" id="highlighter_366114">
                    <div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody>
                            <tr>
                                <code class="code">
                                    <div class="container" title="Hint: double-click to select code">
                                        <div class="line number1 index0 alt2"><code class="java plain">curl -u ncroot:NCROOT_PWD  -XPOST http:</code><code class="java comments">//MSA_IP/ubi-api-rest/ordercommand/get/configuration/311/UPDATE -d '{</code></div>
                                        <div class="line number2 index1 alt1"><code class="java spaces">    </code><code class="java string">"vlan"</code><code class="java plain">: {</code></div>
                                        <div class="line number3 index2 alt2"><code class="java spaces">        </code><code class="java string">"4001"</code><code class="java plain">: {</code></div>
                                        <div class="line number4 index3 alt1"><code class="java spaces">            </code><code class="java string">"name"</code><code class="java plain">: </code><code class="java string">"MyVlan4001"</code><code class="java plain">,</code></div>
                                        <div class="line number5 index4 alt2"><code class="java spaces">            </code><code class="java string">"ports"</code><code class="java plain">: </code><code class="java string">"Fa0\/11"</code><code class="java plain">,</code></div>
                                        <div class="line number6 index5 alt1"><code class="java spaces">            </code><code class="java string">"object_id"</code><code class="java plain">: </code><code class="java string">"4001"</code><code class="java plain">,</code></div>
                                        <div class="line number7 index6 alt2"><code class="java spaces">            </code><code class="java string">"status"</code><code class="java plain">: </code><code class="java string">"active"</code></div>
                                        <div class="line number8 index7 alt1"><code class="java spaces">        </code><code class="java plain">}</code></div>
                                        <div class="line number9 index8 alt2"><code class="java spaces">    </code><code class="java plain">}</code></div>
                                        <div class="line number10 index9 alt1"><code class="java plain">}'</code></div>
                                    </div>
                                </code>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <p>will return</p>
    <div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;">
        <div class="codeContent panelContent pdl">
            <div>
                <div class="syntaxhighlighter sh-confluence nogutter java" id="highlighter_507435">
                    <div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody>
                            <tr>
                                <code class="code">
                                    <div class="container" title="Hint: double-click to select code">
                                        <div class="line number1 index0 alt2"><code class="java plain">{</code></div>
                                        <div class="line number2 index1 alt1"><code class="java spaces">    </code><code class="java string">"commandId"</code><code class="java plain">: </code><code class="java value">0</code><code class="java plain">,</code></div>
                                        <div class="line number3 index2 alt2"><code class="java spaces">    </code><code class="java string">"message"</code><code class="java plain">: </code><code class="java string">"vlan 4002\nname MyVlan4002\n"</code><code class="java plain">,</code></div>
                                        <div class="line number4 index3 alt1"><code class="java spaces">    </code><code class="java string">"status"</code><code class="java plain">: </code><code class="java string">"OK"</code></div>
                                        <div class="line number5 index4 alt2"><code class="java plain">}</code></div>
                                    </div>
                                </code>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <p class="p1"></p>
    <h4 id="MicroservicesOrderCommandRESTAPI-StoreConfiguration"><span class="">S</span><span class="">tore Configuration </span></h4>
    <p>This execution type is used to store the configuration objects in the database.</p>
    <p>The configuration generated by the command is returned to the caller, and the generated objects are stored in the database.</p>
    <p><a class="image-popup-fit-width" href="">
              <img alt="Image" src="images/BFD-Conf-4.png" width="600"/></a></p>
    <p>Web service syntax:</p>
    <div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;">
        <div class="codeContent panelContent pdl">
            <div>
                <div class="syntaxhighlighter sh-confluence nogutter java" id="highlighter_615084">
                    <div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody>
                            <tr>
                                <code class="code">
                                    <div class="container" title="Hint: double-click to select code">
                                        <div class="line number1 index0 alt2"><code class="java plain">PUT /ordercommand/store/configuration/{deviceId}/{commandName} </code></div>
                                        <div class="line number2 index1 alt1"><code class="java plain">body : microservice parameters formatted as JSON</code></div>
                                    </div>
                                </code>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <ul>
        <li><strong>DeviceId</strong> is the ID (long) of the device to manage</li>
        <li><strong>commandName</strong> is the command to apply to the device</li>
        <li><strong>objectParameters</strong> are the JSON formatted list of objects and attributes.</li>
    </ul>
    <h5 id="MicroservicesOrderCommandRESTAPI-Example.1">Example</h5>
    <p>The call below is using the Microservice vlan.xml to do simple VLAN management on a Cisco Catalyst IOS</p>
    <div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;">
        <div class="codeContent panelContent pdl">
            <div>
                <div class="syntaxhighlighter sh-confluence nogutter java" id="highlighter_526363">
                    <div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody>
                            <tr>
                                <code class="code">
                                    <div class="container" title="Hint: double-click to select code">
                                        <div class="line number1 index0 alt2"><code class="java plain">curl -u ncroot:NCROOT_PWD  -XPUT http:</code><code class="java comments">//MSA_IP/ubi-api-rest/ordercommand/store/configuration/311/CREATE -d '{</code></div>
                                        <div class="line number2 index1 alt1"><code class="java spaces">    </code><code class="java string">"vlan"</code><code class="java plain">: {</code></div>
                                        <div class="line number3 index2 alt2"><code class="java spaces">        </code><code class="java string">"4020"</code><code class="java plain">: {</code></div>
                                        <div class="line number4 index3 alt1"><code class="java spaces">            </code><code class="java string">"name"</code><code class="java plain">: </code><code class="java string">"MyVlan4020"</code><code class="java plain">,</code></div>
                                        <div class="line number5 index4 alt2"><code class="java spaces">            </code><code class="java string">"ports"</code><code class="java plain">: </code><code class="java string">"Fa0\/11"</code><code class="java plain">,</code></div>
                                        <div class="line number6 index5 alt1"><code class="java spaces">            </code><code class="java string">"object_id"</code><code class="java plain">: </code><code class="java string">"4020"</code><code class="java plain">,</code></div>
                                        <div class="line number7 index6 alt2"><code class="java spaces">            </code><code class="java string">"status"</code><code class="java plain">: </code><code class="java string">"active"</code></div>
                                        <div class="line number8 index7 alt1"><code class="java spaces">        </code><code class="java plain">}</code></div>
                                        <div class="line number9 index8 alt2"><code class="java spaces">    </code><code class="java plain">}</code></div>
                                        <div class="line number10 index9 alt1"><code class="java plain">}'</code></div>
                                    </div>
                                </code>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <p>will return</p>
    <div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;">
        <div class="codeContent panelContent pdl">
            <div>
                <div class="syntaxhighlighter sh-confluence nogutter java" id="highlighter_690594">
                    <div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody>
                            <tr>
                                <code class="code">
                                    <div class="container" title="Hint: double-click to select code">
                                        <div class="line number1 index0 alt2"><code class="java plain">{</code></div>
                                        <div class="line number2 index1 alt1"><code class="java spaces">    </code><code class="java string">"commandId"</code><code class="java plain">: </code><code class="java value">0</code><code class="java plain">,</code></div>
                                        <div class="line number3 index2 alt2"><code class="java spaces">    </code><code class="java string">"message"</code><code class="java plain">: </code><code class="java string">"vlan 4020\nname MyVlan4020\n"</code><code class="java plain">,</code></div>
                                        <div class="line number4 index3 alt1"><code class="java spaces">    </code><code class="java string">"status"</code><code class="java plain">: </code><code class="java string">"OK"</code></div>
                                        <div class="line number5 index4 alt2"><code class="java plain">}</code></div>
                                    </div>
                                </code>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <p></p>
    <h4 id="MicroservicesOrderCommandRESTAPI-ExecuteCommand"><span class="">E</span><span class="">xecute Command </span></h4>
    <p>This execution type is used to store the configuration in the database and apply it to the device.</p>
    <p>The configuration generated by the command is returned to the caller, the actions are also performed in the database and on the device.</p>
    <p><a class="image-popup-fit-width" href="">
              <img alt="Image" src="images/BFD-Conf-5.png" width="600"/></a></p>
    <p>(This diagram displays the execute command mode on the web)</p>
    <p></p>
    <h1 id="MicroservicesOrderCommandRESTAPI-ExecuteCommand.1">Execute Command</h1>
    <p>Use the following method to trigger OrderCommand (Microservices) methods present at the following URL:</p>
    <div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;">
        <div class="codeContent panelContent pdl">
            <div>
                <div class="syntaxhighlighter sh-confluence nogutter java" id="highlighter_646001">
                    <div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody>
                            <tr>
                                <code class="code">
                                    <div class="container" title="Hint: double-click to select code">
                                        <div class="line number1 index0 alt2"><code class="java plain">http:</code><code class="java comments">//MSA_IP/ubi-api-rest/ordercommand/execute/{deviceId}/{commandName}</code></div>
                                    </div>
                                </code>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <p>Where:<span style="color: rgb(0,0,255);">{deviceId}</span>: is the device sequence number or the numeric part of the MSActivator Device ID<span style="color: rgb(0,0,255);">{commandName}</span>: can take one of the following values:</p>
    <ul>
        <li>UPDATE</li>
        <li>IMPORT</li>
        <li>CREATE</li>
        <li>DELETE</li>
    </ul>
    <p>See the following CURL example:</p>
    <div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;">
        <div class="codeContent panelContent pdl">
            <div>
                <div class="syntaxhighlighter sh-confluence nogutter java" id="highlighter_991845">
                    <div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody>
                            <tr>
                                <code class="code">
                                    <div class="container" title="Hint: double-click to select code">
                                        <div class="line number1 index0 alt2"><code class="java plain">curl -u ncroot:NCROOT_PWD  -XPUT http:</code><code class="java comments">//MSA_IP/ubi-api-rest/ordercommand/execute/311/CREATE -d '{</code></div>
                                        <div class="line number2 index1 alt1"><code class="java spaces">    </code><code class="java string">"vlan"</code><code class="java plain">: {</code></div>
                                        <div class="line number3 index2 alt2"><code class="java spaces">        </code><code class="java string">"4020"</code><code class="java plain">: {</code></div>
                                        <div class="line number4 index3 alt1"><code class="java spaces">            </code><code class="java string">"name"</code><code class="java plain">: </code><code class="java string">"MyVlan4020"</code><code class="java plain">,</code></div>
                                        <div class="line number5 index4 alt2"><code class="java spaces">            </code><code class="java string">"ports"</code><code class="java plain">: </code><code class="java string">"Fa0\/11"</code><code class="java plain">,</code></div>
                                        <div class="line number6 index5 alt1"><code class="java spaces">            </code><code class="java string">"object_id"</code><code class="java plain">: </code><code class="java string">"4020"</code><code class="java plain">,</code></div>
                                        <div class="line number7 index6 alt2"><code class="java spaces">            </code><code class="java string">"status"</code><code class="java plain">: </code><code class="java string">"active"</code></div>
                                        <div class="line number8 index7 alt1"><code class="java spaces">        </code><code class="java plain">}</code></div>
                                        <div class="line number9 index8 alt2"><code class="java spaces">    </code><code class="java plain">}</code></div>
                                        <div class="line number10 index9 alt1"><code class="java plain">}'</code></div>
                                    </div>
                                </code>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <p>As shown above, the http body contains what's called "object parameters" in general.</p>
    <h2 id="MicroservicesOrderCommandRESTAPI-RootElement">Root Element</h2>
    <p>The root element of the JSON body is the Microservice definition identifier. Here, the first JSON element refers to the Microservice definition name.</p>
    <p>In the example above it is "<strong>syslogd</strong>". This is the same string that is used when creating a Microservice definition in the Microservices builder. Hence, in the above case the Microservice was named: <strong>"syslogd.xml"</strong></p>
    <h2 id="MicroservicesOrderCommandRESTAPI-MicroserviceInstanceJSONObject">Microservice Instance JSON Object</h2>
    <p>The JSON element at the next level is the object_id of the Microservice instance, in the above case it is: "SyslogConf".</p>
    <div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info">
        
    </div>
    <h2 id="MicroservicesOrderCommandRESTAPI-MicroserviceInstanceVariables">Microservice Instance Variables</h2>
    <p>The third level of JSON elements is the instance variables, represented in a standard name-value pair.</p>
    <p>In this case the {commandName} value is IMPORT (import operation of Microservice) and the http response body will contain the list of Microservice instances.</p>
    <p>As an example, let's say we have three instances of "syslogd" Microservices on the device, with instance names:</p>
    <ul>
        <li>SyslogConf</li>
        <li>MSASyslogConf </li>
        <li>NMSSyslogconf</li>
    </ul>
    <p>The response of the import will be the following JSON object, that will be part of http response:</p>
    <div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;">
        <div class="codeContent panelContent pdl">
            <div>
                <div class="syntaxhighlighter sh-confluence nogutter java" id="highlighter_127885">
                    <div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody>
                            <tr>
                                <code class="code">
                                    <div class="container" title="Hint: double-click to select code">
                                        <div class="line number1 index0 alt2"><code class="java plain">{</code></div>
                                        <div class="line number2 index1 alt1"><code class="java spaces">  </code><code class="java string">"syslogd"</code><code class="java plain">: {</code></div>
                                        <div class="line number3 index2 alt2"><code class="java spaces">    </code><code class="java string">"SyslogConf"</code><code class="java plain">: {</code></div>
                                        <div class="line number4 index3 alt1"><code class="java spaces">      </code><code class="java string">"object_id"</code><code class="java plain">: </code><code class="java string">"SyslogConf"</code><code class="java plain">,</code></div>
                                        <div class="line number5 index4 alt2"><code class="java spaces">      </code><code class="java string">"syslogd3_status"</code><code class="java plain">: </code><code class="java string">"enable"</code><code class="java plain">,</code></div>
                                        <div class="line number6 index5 alt1"><code class="java spaces">      </code><code class="java string">"syslogd3_port"</code><code class="java plain">: </code><code class="java string">"514"</code><code class="java plain">,</code></div>
                                        <div class="line number7 index6 alt2"><code class="java spaces">      </code><code class="java string">"syslogd3_server_ip"</code><code class="java plain">: </code><code class="java string">"1.2.2.3"</code></div>
                                        <div class="line number8 index7 alt1"><code class="java spaces">    </code><code class="java plain">}</code></div>
                                        <div class="line number9 index8 alt2"><code class="java spaces">    </code><code class="java string">"MSASyslogConf"</code><code class="java plain">: {</code></div>
                                        <div class="line number10 index9 alt1"><code class="java spaces">      </code><code class="java string">"object_id"</code><code class="java plain">: </code><code class="java string">"MSASyslogConf"</code><code class="java plain">,</code></div>
                                        <div class="line number11 index10 alt2"><code class="java spaces">      </code><code class="java string">"syslogd3_status"</code><code class="java plain">: </code><code class="java string">"enable"</code><code class="java plain">,</code></div>
                                        <div class="line number12 index11 alt1"><code class="java spaces">      </code><code class="java string">"syslogd3_port"</code><code class="java plain">: </code><code class="java string">"514"</code><code class="java plain">,</code></div>
                                        <div class="line number13 index12 alt2"><code class="java spaces">      </code><code class="java string">"syslogd3_server_ip"</code><code class="java plain">: </code><code class="java string">"2.3.4.5"</code></div>
                                        <div class="line number14 index13 alt1"><code class="java spaces">    </code><code class="java plain">}</code></div>
                                        <div class="line number15 index14 alt2"><code class="java spaces">    </code><code class="java string">"NMSSyslogconf"</code><code class="java plain">: {</code></div>
                                        <div class="line number16 index15 alt1"><code class="java spaces">      </code><code class="java string">"object_id"</code><code class="java plain">: </code><code class="java string">"NMSSyslogconf"</code><code class="java plain">,</code></div>
                                        <div class="line number17 index16 alt2"><code class="java spaces">      </code><code class="java string">"syslogd3_status"</code><code class="java plain">: </code><code class="java string">"disable"</code><code class="java plain">,</code></div>
                                        <div class="line number18 index17 alt1"><code class="java spaces">      </code><code class="java string">"syslogd3_port"</code><code class="java plain">: </code><code class="java string">"514"</code><code class="java plain">,</code></div>
                                        <div class="line number19 index18 alt2"><code class="java spaces">      </code><code class="java string">"syslogd3_server_ip"</code><code class="java plain">: </code><code class="java string">"7.6.5.4"</code></div>
                                        <div class="line number20 index19 alt1"><code class="java spaces">    </code><code class="java plain">}</code></div>
                                        <div class="line number21 index20 alt2"><code class="java spaces">  </code><code class="java plain">}</code></div>
                                        <div class="line number22 index21 alt1"><code class="java plain">}</code></div>
                                    </div>
                                </code>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

        </div>