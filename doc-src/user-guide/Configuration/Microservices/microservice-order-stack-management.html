<div class="documentation-content">


        <div class="wiki-content" id="main-content">

        <h2 id="MicroserviceOrderStackManagement-Overview"><span class="">Overview</span></h2><p>When using the <a href="/documentation/microservices/">Microservice</a> console to configure a device, the user is actually stacking order, and the actual configuration is built and pushed once they click on the button "Apply configuration".</p><p>This allows the user to build a complete set of configurations before triggering the actual configuration on the managed device.</p><p>The stack management used by the Microservice GUI is also available via the REST API.</p><p>This document illustrates how to use the API to manage the Microservice stack.</p><h2 id="MicroserviceOrderStackManagement-HowtoUsetheAPI"><span class="">How to Use the API</span></h2><p>Use case: route management on a firewall. </p><p>Initial state: no route defined on the firewall.</p>
        <p><a class="image-popup-fit-width" href="">
              <img alt="Image" src="images/Objects_Stack_Management_route_1.png" width="800"/></a></p>
        <p></p><p>Use the WS (web server) to add a route: SOAP request.</p><pre class="highlight">&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ws="http://ws.ubiqube.com"&gt;
   &lt;soapenv:Header/&gt;
   &lt;soapenv:Body&gt;
      &lt;ws:pushOrderCommand&gt;
         &lt;deviceId&gt;338&lt;/deviceId&gt;
         &lt;commandName&gt;CREATE&lt;/commandName&gt;
         &lt;objectParameters&gt;{"routing":{"1":{"subnet":"10.20.50.0","comment":"","interface":"port1","object_id":"1","gateway":"10.20.50.254","mask":"255.255.255.0"}}}&lt;/objectParameters&gt;
      &lt;/ws:pushOrderCommand&gt;
   &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
 </pre><p>Returns the stack position ID for this order.</p><pre class="highlight">&lt;env:Envelope xmlns:env="http://schemas.xmlsoap.org/soap/envelope/"&gt;
   &lt;env:Header/&gt;
   &lt;env:Body&gt;
      &lt;ns2:pushOrderCommandResponse xmlns:ns2="http://ws.ubiqube.com"&gt;
         &lt;return&gt;1&lt;/return&gt;
      &lt;/ns2:pushOrderCommandResponse&gt;
   &lt;/env:Body&gt;
&lt;/env:Envelope&gt;
</pre><p>Other orders can be pushed and once all order are pushed, it is possible for the GUI to trigger the configuration by clicking the button "Apply configuration":</p>
<p><a class="image-popup-fit-width" href="">
              <img alt="Image" src="images/Objects_Stack_Management_route_2.png" width="800"/></a></p>
<p></p><p>Or with a SOAP call:</p><pre class="highlight">&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ws="http://ws.ubiqube.com"&gt;
   &lt;soapenv:Header/&gt;
   &lt;soapenv:Body&gt;
      &lt;ws:executeStack&gt;
         &lt;deviceId&gt;338&lt;/deviceId&gt;
      &lt;/ws:executeStack&gt;
   &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
</pre><p>And clean the stack.</p><pre class="highlight">&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ws="http://ws.ubiqube.com"&gt;
   &lt;soapenv:Header/&gt;
   &lt;soapenv:Body&gt;
      &lt;ws:clearStack&gt;
         &lt;deviceId&gt;338&lt;/deviceId&gt;
      &lt;/ws:clearStack&gt;
   &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
</pre>
<p>The GUI (after a browser refresh) should look like this:</p>
Objects_Stack_Management_route_3
<p><a class="image-popup-fit-width" href="">
              <img alt="Image" src="images/Objects_Stack_Management_route_3.png" width="800"/></a></p>
        </div>


        </div>