<div class="documentation-content">

<div class="wiki-content" id="main-content">

        <h1 id="MicroserviceOrderStackManagementAPI-Overview">Overview</h1><p>This documentation describes the order stack management API.</p><p>This REST API is also used internally by the MSActivator portal, as an example you can read the page on <a href="../Configuration/Microservices/microservice-order-stack-management.adoc">Microservice Order Stack Management</a>.</p><p>Each API is described below with the REST call, a textual description, the parameters and a section 'detail'. The 'detail' section provides some insight into the inner workings of the API. For instance, what is the database table impacted or what SecEngine API command is being used.</p><p>The detail on the SecEngine API command is very important because it is directly related to the <strong>adaptor implementation</strong> for a specific vendor.</p><h1 id="MicroserviceOrderStackManagementAPI-APIDescription">API Description</h1><h2 id="MicroserviceOrderStackManagementAPI-AddanOrdertotheStack">Add an Order to the Stack</h2><div class="confluence-information-macro has-no-icon confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><div class="confluence-information-macro-body"><p>curl -u ncroot:ncroot_pwd -XPUT <span class="nolink"><span class="nolink">http://MSA_IP/ubi-api-rest/orderstack/command/{deviceId}/{commandName</span></span>} -d {objectParameters}</p></div></div><h3 id="MicroserviceOrderStackManagementAPI-Description">Description</h3><p>Adds a command in the stack and returns the ID of the order in the stack.</p><h3 id="MicroserviceOrderStackManagementAPI-Parameters">Parameters</h3><p><strong>deviceId</strong>: the database identifier of the managed device, for example: 123.<strong>commandName</strong>: possible values are CREATE UPDATE IMPORT DELETE<strong>objectParameters</strong>: in JSON format, for example:</p><pre>'{"interface" : {   "port2" : {       "ip" : "1.2.4.5",       "object_id" : "port2",       "mask" : "255.255.255.0"         }     }}'</pre><h3 id="MicroserviceOrderStackManagementAPI-Detail">Detail</h3><p>Write into database (redsms.sd_crud_object).</p><p></p><h2 id="MicroserviceOrderStackManagementAPI-GeneratetheConfigurationfromtheStack">Generate the Configuration from the Stack</h2><div class="confluence-information-macro has-no-icon confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><div class="confluence-information-macro-body"><p>curl -u ncroot:ncroot_pwd -XGET <span class="nolink"><span class="nolink">http://MSA_IP/ubi-api-rest/orderstack/configuration/{deviceId</span></span>}</p></div></div><h3 id="MicroserviceOrderStackManagementAPI-Description.1">Description</h3><p>Generates the configuration based on the stacked orders for a device.</p><h3 id="MicroserviceOrderStackManagementAPI-Parameters.1">Parameters</h3><p><strong>deviceId</strong>: the database identifier of the managed device, for example: 123.</p><h3 id="MicroserviceOrderStackManagementAPI-Detail.1">Detail</h3><p>loop on commands in the stack  call SMS verb end loop</p><p>The SMS verb is equivalent to the following CLI command command:</p><pre>sms -e JSCALLCOMMAND -i 'deviceId commandName 0' -c 'objectParameters'</pre>
        <div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><p class="title">NOTE: Note</p>
          <div class="confluence-information-macro-body"><p>In the CLI command above the parameter 0 is used along with commands such as CREATE, UPDATE or DELETE and <strong>generate configuration without access to the database or the device</strong></p></div></div><h2 id="MicroserviceOrderStackManagementAPI-GeneratstheConfigurationandStoretheConfigurationfromtheStack">Generats the Configuration and Store the Configuration from the Stack</h2><div class="confluence-information-macro has-no-icon confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><div class="confluence-information-macro-body"><p>curl -u ncroot:ncroot_pwd -XPUT <span class="nolink"><span class="nolink">http://MSA_IP/ubi-api-rest/orderstack/configuration/{deviceId</span></span>}</p></div></div><h3 id="MicroserviceOrderStackManagementAPI-Description.2">Description</h3><p>Generates the configuration based on the stacked orders for a device and stores the configuration items in the database.</p><h3 id="MicroserviceOrderStackManagementAPI-Parameters.2">Parameters</h3><p><strong>deviceId</strong>: the database identifier of the managed device, for example: 123.</p><h3 id="MicroserviceOrderStackManagementAPI-Detail.2">Detail</h3><p>loop on commands in the stack  call SMS verb  write in database (redsms.sd_crud_object)end loop</p><p>The SMS verb is equivalent to the following command: <code>sms -e JSCALLCOMMAND -i 'deviceId commandName 1' -c 'objectParameters'</code></p><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><p class="title">NOTE: Note</p><div class="confluence-information-macro-body"><p>In the CLI command above the parameter 1 is used along with commands such as CREATE, UPDATE or DELETE and generate the configuration and <strong>stores the configuration items in the database.</strong></p><p>The device configuration is not impacted.<strong></strong></p></div></div><h2 id="MicroserviceOrderStackManagementAPI-GeneratetheConfigurationfromtheStackandApplytotheDevice">Generate the Configuration from the Stack and Apply to the Device</h2><div class="confluence-information-macro has-no-icon confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><div class="confluence-information-macro-body"><p>curl -u ncroot:ncroot_pwd -XPOST <span class="nolink"><span class="nolink">http://MSA_IP/ubi-api-rest/orderstack/execute/{deviceId</span></span>}</p></div></div><h3 id="MicroserviceOrderStackManagementAPI-Description.3">Description</h3><p>Generates the configuration based on the stacked orders for a device and stores the configuration items in the database and executes all the commands on the device.</p><h3 id="MicroserviceOrderStackManagementAPI-Parameters.3">Parameters</h3><p><strong>deviceId</strong>: the database identifier of the managed device, for example: 123.</p><h3 id="MicroserviceOrderStackManagementAPI-Detail.3">Detail</h3><p>loop on commands in the stack  call SMS verb  write in database (table redsms.sd_crud_object)  execute command on the deviceend loop</p><p>The SMS verb is equivalent to the following command: <code>sms -e JSCALLCOMMAND -i 'deviceId commandName 2' -c 'objectParameters'</code></p><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><p class="title">NOTE: Note</p><div class="confluence-information-macro-body"><p>In the CLI command above the parameter 2 is used along with commands such as CREATE, UPDATE or DELETE and generate the configuration, stores the configuration items in the database and <strong>applies the configuration</strong> to the device.</p></div></div><h2 id="MicroserviceOrderStackManagementAPI-ListtheOrdersintheStack">List the Orders in the Stack</h2><div class="confluence-information-macro has-no-icon confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><div class="confluence-information-macro-body"><p>curl -u ncroot:ncroot_pwd -XGET <span class="nolink"><span class="nolink">http://MSA_IP/ubi-api-rest/orderstack/{deviceId</span></span>}</p></div></div><h3 id="MicroserviceOrderStackManagementAPI-Description.4">Description</h3><p>Lists the stacked orders for a device.</p><h3 id="MicroserviceOrderStackManagementAPI-Parameters.4">Parameters</h3><p><strong>deviceId</strong>: the database identifier of the managed device, for example: 123.</p><h3 id="MicroserviceOrderStackManagementAPI-Detail.4">Detail</h3><p>Read from the database (table redsms.sd_crud_object).</p><h2 id="MicroserviceOrderStackManagementAPI-GettheDetailofaStackCommand">Get the Detail of a Stack Command</h2><div class="confluence-information-macro has-no-icon confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><div class="confluence-information-macro-body"><p>curl -u  ncroot:ncroot_pwd -XGET <span class="nolink"><span class="nolink">http://MSA_IP/ubi-api-rest/orderstack/command/{deviceId}/{commandId</span></span>}</p></div></div><h3 id="MicroserviceOrderStackManagementAPI-Description.5">Description</h3><p>Gets the detail of a stack command based on its identifier in the stack.</p><h3 id="MicroserviceOrderStackManagementAPI-Parameters.5">Parameters</h3><p><strong>deviceId</strong>: the database identifier of the managed device, for example: 123.<strong>commandId</strong>: the identifier of the command in the stack.</p><h3 id="MicroserviceOrderStackManagementAPI-Detail.5">Detail</h3><p>Read in database (redsms.sd_crud_object).</p><h2 id="MicroserviceOrderStackManagementAPI-CleartheStack">Clear the Stack</h2><div class="confluence-information-macro has-no-icon confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><div class="confluence-information-macro-body"><p>curl -u ncroot:ncroot_pwd -XDELETE <span class="nolink"><span class="nolink">http://MSA_IP/ubi-api-rest/orderstack/{deviceId</span></span>}</p></div></div><h3 id="MicroserviceOrderStackManagementAPI-Description.6">Description</h3><p>Clears the stack for a device.</p><h3 id="MicroserviceOrderStackManagementAPI-Parameters.6">Parameters</h3><p><strong>deviceId</strong>: the database identifier of the managed device, for example: 123.</p><h3 id="MicroserviceOrderStackManagementAPI-Detail.6">Detail</h3><p>Remove in database (redsms.sd_crud_object)</p><h2 id="MicroserviceOrderStackManagementAPI-DeleteaCommandfromtheStack">Delete a Command from the Stack</h2><div class="confluence-information-macro has-no-icon confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><div class="confluence-information-macro-body"><p>curl -u  ncroot:ncroot_pwd -XDELETE <span class="nolink"><span class="nolink">http://MSA_IP/ubi-api-rest/orderstack/command/{deviceId}/{commandId</span></span>}</p></div></div><h3 id="MicroserviceOrderStackManagementAPI-Description.7">Description</h3><p>Deletes a command from the stack based on the command ID.</p><h3 id="MicroserviceOrderStackManagementAPI-Parameters.7">Parameters</h3><p><strong>deviceId</strong>: the database identifier of the managed device, for example: 123.<strong>commandId</strong>: the identifier of the command in the stack.</p><h3 id="MicroserviceOrderStackManagementAPI-Detail.7">Detail</h3><p>Remove in database (redsms.sd_crud_object).</p><h2 id="MicroserviceOrderStackManagementAPI-ApplytheConfigurationforaDevice">Apply the Configuration for a Device</h2><div class="confluence-information-macro has-no-icon confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><div class="confluence-information-macro-body"><p>curl -u ncroot:ncroot_pwd -XPUT <span class="nolink"><span class="nolink">http://MSA_IP/ubi-api-rest/device/push_configuration/{deviceId</span></span>} -d {configuration}</p></div></div><h3 id="MicroserviceOrderStackManagementAPI-Description.8">Description</h3><p>Perform a push configuration for a device.</p><h3 id="MicroserviceOrderStackManagementAPI-Parameters.8">Parameters</h3><p><strong>deviceId</strong>: the database identifier of the managed device, for example: 123.<strong>configuration</strong>: the configuration in JSON format.</p><p>Example:</p><pre>{</pre><pre>    "configuration": "config system interface\nedit port1\nset ip 192.168.1.10 255.255.255.0\nend"</pre><pre>}</pre><h3 id="MicroserviceOrderStackManagementAPI-Detail.8">Detail</h3><p>Applies the configuration to the device.</p><h2 id="MicroserviceOrderStackManagementAPI-GettheStatusofthepush_configurationAPI">Get the Status of the push_configuration API</h2><div class="confluence-information-macro has-no-icon confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><div class="confluence-information-macro-body"><p>curl -u ncroot:ncroot_pwd  -X GET <span class="nolink"><span class="nolink">http://MSA_IP/ubi-api-rest/device/push_configuration/status/{deviceId</span></span>}</p></div></div><h3 id="MicroserviceOrderStackManagementAPI-Description.9">Description</h3><p>Gets the status of the push configuration from the device.</p><h3 id="MicroserviceOrderStackManagementAPI-Parameters.9">Parameters</h3><p><strong>deviceId</strong>: the database identifier of the managed device, for example: 123.</p><h3 id="MicroserviceOrderStackManagementAPI-Detail.9">Detail</h3><p>Read the status from the database.</p><p></p><p></p>




        </div>



        </div>